# Проект "Виджет"

## Описание:

Это виджет, который показывает несколько последних успешных банковских операций клиента.

## Установка:

* Клонируйте репозиторий:
  ```
  https://github.com/MrchknRV/Python_Homework.git
  ```
* Установите `poetry`
  ```
  pip install poetry
  ```
  Если `poetry` установлен, установите зависимости:
  ```
  # для первичной установки
  poetry install
  # для обновления
  poetry update
  ```
  Для просмотра установленных зависимостей используйте `poetry show --tree`

### Как работать

## Модуль main.py

Функция main в модуле main отвечает за основную логику проекта и связывает функциональности между собой.
Ожидаемое поведение программы должно быть следующим:
Программа: Привет! Добро пожаловать в программу работы
с банковскими транзакциями.
Выберите необходимый пункт меню:

1. Получить информацию о транзакциях из JSON-файла
2. Получить информацию о транзакциях из CSV-файла
3. Получить информацию о транзакциях из XLSX-файла

Пользователь: 1

Программа: Для обработки выбран JSON-файл.
Программа: Введите статус, по которому необходимо выполнить фильтрацию.
Доступные для фильтровки статусы: EXECUTED, CANCELED, PENDING

Пользователь: EXECUTED

Программа: Операции отфильтрованы по статусу "EXECUTED"
В случае, если пользователь ввел неверный статус, программа не должна падать в ошибку, а должна возвращать пользователя
к вводу корректного статуса:
Пользователь: test

Программа: Статус операции "test" недоступен.

Программа: Введите статус, по которому необходимо выполнить фильтрацию.
Доступные для фильтровки статусы: EXECUTED, CANCELED, PENDING
После фильтрации программа выводит следующие вопросы для уточнения выборки операций, необходимых пользователю, и
выводит в консоль операции, соответствующие выборке пользователя:
Программа: Отсортировать операции по дате? Да/Нет

Пользователь: да

Программа: Отсортировать по возрастанию или по убыванию?

Пользователь: по возрастанию/по убыванию

Программа: Выводить только рублевые тразакции? Да/Нет

Пользователь: да

Программа: Отфильтровать список транзакций по определенному слову
в описании? Да/Нет

Пользователь: да/нет

Программа: Распечатываю итоговый список транзакций...

Программа:
Всего банковских операций в выборке: 4

08.12.2019 Открытие вклада
Счет **4321
Сумма: 40542 руб.

12.11.2019 Перевод с карты на карту
MasterCard 7771 27** **** 3727 -> Visa Platinum 1293 38** **** 9203
Сумма: 130 USD
Если выборка оказалась пустой, программа выводит сообщение:

Программа: Не найдено ни одной транзакции, подходящей под ваши
условия фильтрации

## Модуль masks

1. Принимает номер карты отдает на выход маску номера карты

- функция `get_mask_card_number`
- пример маски номера 7000 79** **** 6361

2. Принимает номер счета отдает на выход маску номера счета

- функция `get_mask_account`
- пример маски номера **4305

## Модуль widget

1. Принимает имя и номер карты или счета отдает на выход имя и маску номера карты или счета

- Функция `mask_account_card`
- Пример ввода: Visa Platinum 7000 7922 8960 6361
- Счет 73654108430135874305
- Visa Classic 6831982476737658

2. Маску номера получает в модуле `masks`

## Модуль processing

1. Принимает список словарей и возвращает отсортированный по ключу "state"

- функция `filter_by_state`

3. Принимает список словарей и возвращает отсортированный по ключу "date"

- функция `sort_by_date`
- сортировка True - по убыванию, False - по возрастанию

4. Принимает список словарей и строку для фильтрации, возвращает отсортированный список словарей по строке

- функция `search_banking_transactions_by_string`

5. Функция принимает список словарей с данными о банковских операциях и список категорий операций, а возвращает
   словарь, в котором ключи — это названия категорий, а значения — это количество операций в каждой категории.

- функция `get_count_transactions_category`
-

## Модуль generators

1. Функция `filter_by_currency` выдает транзакции, где валюта операции соответствует заданной.
2. Функция `transaction_description` принимает список словарей с транзакциями и возвращает описание
   каждой операции по очереди.
3. Функция `card_number_generator` может сгенерировать номера карт в заданном диапазоне
   от 0000 0000 0000 0001 до 9999 9999 9999 9999.

## Модуль utils

1. Функция `get_financial_transaction_data` принимает на вход путь до JSON-файла и возвращает список словарей с данными
   о
   финансовых транзакциях.
2. JSON-файл находится в директории `data`.

## Модуль external_api

1. Функция конвертации transaction_amount, которая принимает на вход транзакцию и возвращает сумму транзакции (amount) в
   рублях. Если транзакция была в USD или EUR, происходит обращение к внешнему API для получения текущего курса валют и
   конвертации суммы операции в рубли

## Модуль csv_xlsx_reader

1. Функция `reader_file_transactions_csv` для считывания финансовых операций из CSV принимает путь к файлу CSV в
   качестве аргумента,
   выдает список словарей с транзакциями.
2. Функция `reader_file_transactions_xlxs` для считывания финансовых операций из Excel принимает путь к файлу Excel в
   качестве
   аргумента, выдает список словарей с транзакциями.

###### Пример использования

```python
from src.csv_xlsx_reader import reader_file_transactions_csv, reader_file_transactions_xlxs

# Пример использования функции для CSV
transactions_csv = reader_file_transactions_csv('path/to/transactions.csv')
print(transactions_csv)

# Пример использования функции для Excel
transactions_excel = reader_file_transactions_xlxs('path/to/transactions.xlsx')
print(transactions_excel)
```

### Docstring и аннотации типов

1. все функции должны содержать docstring и корректные аннотации типов.
2. Пример docstring:
    ```python
   def example_function(param1: int, param2: str) -> bool:
         """
         Описание функции.
         :param param1: Описание параметра 1
         :param param2: Описание параметра 2
         :return: Описание возвращаемого значения
         """
         pass
     ```

## Логирование

1. Файлы логов записываются в папку logs
2. Для модуля masks.py - mask.log
3. Для модуля utils.py - utils.log
4. Файлы логов перезаписываемые

## Тестирование

Перед запуском тестов убедитесь, что все зависимости установлены:

* Установка через `poetry`:
  ```poetry add --group dev pytest```

####

* Для запуска тестов используйте команду `pytest`

####

* Для проверки отдельного модуля поможет команда:```pytest .\tests\test_masks.py #или любой другой модуль```

####

* Для проверки code coverage необходимо установить зависимость `poetry add --group dev pytest-cov`.
  Активировать можно с помощью команда `poetry run pytest --cov` - через `poetry` или `pytest --cov` - если активировать
  через виртуальное окружение.
  Чтобы посмотреть отчет о покрытие в формате HTML: `poetry --cov=src --cov-report=html`.
  Посмотреть процент покрытия тестов можно в файле `index.html` через браузер в папке `htmlcov`

####

* Проверить стиль кода можно с помощью линтеров командами:
  ```
  flake8 .
  mypy .
  ```

###### Отчет о покрытии тестами будет доступен в htmlcov/index.html после запуска тестов с параметром

`--cov-report=html`.
